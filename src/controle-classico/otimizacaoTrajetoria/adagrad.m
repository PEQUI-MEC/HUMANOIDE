%-----------------------------------------------------------
%Método do adagrad utilizado para 
%otimizar a trajetória do centro de massa do modelo 3D dual SLIP
%-----------------------------------------------------------
function [U,G0] = adagrad(U0,X0,G0)
%-----------------------------------------------------------
%variáveis globais
%-----------------------------------------------------------
    global ganhoAlpha 
    
    h = 10^-8; 
%-----------------------------------------------------------
%valor do ganho anterior
%-----------------------------------------------------------
    G1 = G0(1,1);
    G2 = G0(2,1);
    G3 = G0(3,1);
    G4 = G0(4,1);
%-----------------------------------------------------------
%cálculo do gradiente da função
%-----------------------------------------------------------    
    G = gradienteFuncao(X0,U0);
    g1 = G(1,1);
    g2 = G(2,1);
    g3 = G(3,1);
    g4 = G(4,1);
%-----------------------------------------------------------
%cálculo do novo ganho
%-----------------------------------------------------------      
    G1 = G1 + g1*g1;
    G2 = G2 + g2*g2;
    G3 = G3 + g3*g3;
    G4 = G4 + g4*g4;
    G0 = [G1;G2;G3;G4];
%-----------------------------------------------------------
%atualizando o valor do vetor de controle - U 
%-----------------------------------------------------------     
    u1 = U0(1,1) - (ganhoAlpha/(sqrt(G1+h)))*g1;
    u2 = U0(2,1) - (ganhoAlpha/(sqrt(G2+h)))*g2;
    u3 = U0(3,1) - (ganhoAlpha/(sqrt(G3+h)))*g3;
    u4 = U0(4,1) - (ganhoAlpha/(sqrt(G4+h)))*g4;
    u5 = U0(5,1);
%-----------------------------------------------------------
%Valor atualizado
%-----------------------------------------------------------        
    U = [u1;u2;u3;u4;u5];
end